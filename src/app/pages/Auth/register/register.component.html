<div class="d-flex align-items-center justify-content-center vh-100 bg-light">
  <div class="card shadow-lg p-4 w-100" style="max-width: 550px; border-radius: 20px; margin: 20px;">
    
    <div class="role-selection text-center mb-4">
      <h3 class="fw-bold text-primary mb-3">Select Your Role</h3>

      <div class="d-flex justify-content-center position-relative role-buttons" #roleButtons>
        <div #roleHighlight class="role-highlight"></div>

        <button *ngFor="let r of roles" 
                class="btn role-btn mx-2 fw-semibold"
                [class.active]="registerData.role === r.value"
                (click)="selectRole(r)">
          {{ r.label }}
        </button>
      </div>
    </div>

    <div *ngIf="registerData.role !== -1" 
         class="animate__animated animate__fadeIn">
      
      <h3 class="text-center text-primary fw-bold mb-4">
        {{ selectedRoleLabel }} Registration
      </h3>

      <form (ngSubmit)="onRegister()" #registerForm="ngForm" novalidate>
        <div class="mb-3">
          <label class="form-label fw-semibold"><i class="fa-solid fa-user"></i> Full Name</label>
          <input type="text" name="fullName" [(ngModel)]="registerData.fullName"
            class="form-control form-control-lg" placeholder="Enter your full name"
            required #fullName="ngModel">
          <div *ngIf="fullName.invalid && fullName.touched" class="text-danger">
            Full Name is required.
          </div>
        </div>

        <div class="mb-3">
          <label class="form-label fw-semibold"><i class="fa-solid fa-envelope"></i> Email</label>
          <input type="email" name="email" [(ngModel)]="registerData.email"
            class="form-control form-control-lg" placeholder="Enter your email"
            required email #email="ngModel">
          <div *ngIf="email.invalid && email.touched" class="text-danger">
            <div *ngIf="email.errors?.['required']">Email is required.</div>
            <div *ngIf="email.errors?.['email']">Invalid email format.</div>
          </div>
        </div>

        <div class="mb-3">
          <label class="form-label fw-semibold"><i class="fa-solid fa-key"></i> Password</label>
          <input type="password" name="password" [(ngModel)]="registerData.password"
            class="form-control form-control-lg" placeholder="Enter a strong password"
            required minlength="6" #password="ngModel">
          <div *ngIf="password.invalid && password.touched" class="text-danger">
            <div *ngIf="password.errors?.['required']">Password is required.</div>
            <div *ngIf="password.errors?.['minlength']">Password must be at least 6 characters.</div>
          </div>
        </div>

        <div class="mb-3">
          <label class="form-label fw-semibold"><i class="fa-solid fa-lock"></i> Confirm Password</label>
          <input type="password" name="confirmPassword" [(ngModel)]="confirmPassword"
            class="form-control form-control-lg" placeholder="Re-enter password"
            required #confirmPasswordModel="ngModel">
          <div *ngIf="confirmPasswordModel.invalid && confirmPasswordModel.touched" class="text-danger">
            Confirm Password is required.
          </div>
          <div *ngIf="confirmPassword && registerData.password !== confirmPassword && confirmPasswordModel.touched" class="text-danger">
            Passwords do not match.
          </div>
        </div>

        <div class="mb-3">
          <label class="form-label fw-semibold"><i class="fa-solid fa-phone"></i> Phone</label>
          <input type="number" name="phone" [(ngModel)]="registerData.phone"
            class="form-control form-control-lg" placeholder="Enter your phone number"
            required pattern="^[0-9]{10}$" #phone="ngModel">
          <div *ngIf="phone.invalid && phone.touched" class="text-danger">
            <div *ngIf="phone.errors?.['required']">Phone number is required.</div>
          </div>
        </div>

        <div class="mb-3" *ngIf="registerData.role === 1 || registerData.role === 2">
          <label class="form-label fw-semibold"><i class="fa-solid fa-building"></i> Department</label>
          <select name="departmentId" [(ngModel)]="registerData.departmentId"
            class="form-select form-select-lg" required #departmentId="ngModel">
            <option [ngValue]="null">-- Select Department --</option>
            <option *ngFor="let dept of departments" [value]="dept.departmentId">{{ dept.departmentName }}</option>
          </select>
          <div *ngIf="departmentId.invalid && departmentId.touched" class="text-danger">
            Please select a department.
          </div>
        </div>

        <button type="submit" class="btn btn-primary btn-lg w-100 fw-semibold mt-2"
          [disabled]="registerForm.invalid || registerData.password !== confirmPassword">
          ðŸš€ Register
        </button>
      </form>
    </div>

    <p class="mt-3 text-center text-muted" *ngIf="registerData.role !== -1">
      Already have an account?
      <a routerLink="/login" class="text-decoration-none text-primary fw-bold">Login</a>
    </p>
  </div>
</div>
