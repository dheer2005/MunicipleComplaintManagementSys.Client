 <!-- Create New Department Section -->
  <div class="mt-5">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h4 class="fw-bold text-gradient">
        <i class="fas fa-plus-circle me-2"></i> Create New Department
      </h4>
    </div>

    <div class="card shadow-sm border-0 rounded-3 p-4 mb-5">
      <form>
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label fw-semibold">
              <i class="fas fa-building me-2 text-primary"></i>Department Name
            </label>
            <input
              type="text"
              class="form-control"
              [(ngModel)]="newDepartment.departmentName"
              name="deptName"
              placeholder="Enter department name"
            >
          </div>
          <!-- <div class="col-md-6">
            <label class="form-label fw-semibold">
              <i class="fas fa-info-circle me-2 text-primary"></i>Department Code
            </label>
            <input
              type="text"
              class="form-control"
              [(ngModel)]="newDepartment.code"
              name="deptCode"
              placeholder="Enter department code"
            >
          </div>
          <div class="col-12">
            <label class="form-label fw-semibold">
              <i class="fas fa-align-left me-2 text-primary"></i>Description
            </label>
            <textarea
              class="form-control"
              [(ngModel)]="newDepartment.description"
              name="deptDesc"
              rows="3"
              placeholder="Enter department description"
            ></textarea>
          </div> -->
          <div class="col-md-3 mt-5">
            <label class="form-label text-muted small mb-">&nbsp;</label>
            <button
              type="button"
              class="btn btn-outline-primary"
              (click)="createDepartment()"
              [disabled]="!newDepartment.departmentName"
            >
              <i class="fas fa-save me-2"></i>Create Department
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>

  <!-- Categories & Sub-categories Management Section -->
  <div class="mt-5">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h4 class="fw-bold text-gradient">
        <i class="fas fa-layer-group me-2"></i> Categories & Sub-categories Management
      </h4>
    </div>

    <!-- Select Department for Categories -->
    <div class="card shadow-sm border-0 rounded-3 p-3 mb-4">
      <div class="d-flex align-items-center gap-3 flex-wrap">
        <label for="categoryDepartmentSelect" class="form-label fw-semibold mb-0">
          <i class="fas fa-sitemap me-2 text-primary"></i> Select Department:
        </label>
        <select
          id="categoryDepartmentSelect"
          class="form-select w-auto"
          [(ngModel)]="selectedCategoryDepartmentId"
          (change)="onCategoryDepartmentChange()"
        >
          <option selected disabled value=-1>-- Select Department --</option>
          <option *ngFor="let dept of departments" [ngValue]="dept.departmentId">
            {{ dept.departmentName }}
          </option>
        </select>
      </div>
    </div>

    <div *ngIf="selectedCategoryDepartmentId != -1">
      <!-- Create Category -->
      <div class="card shadow-sm border-0 rounded-3 p-4 mb-4">
        <h6 class="fw-semibold mb-3">
          <i class="fas fa-folder-plus text-success me-2"></i>Create New Category
        </h6>
        <div class="row g-3">
          <div class="col-md-4">
            <input
              type="text"
              class="form-control"
              [(ngModel)]="newCategory.categoryName"
              placeholder="Enter category name"
            >
          </div>
          <div class="col-md-4">
            <input
              type="number"
              class="form-control"
              [(ngModel)]="newCategory.defaultSlaHours"
              placeholder="Enter default SlaHours"
            >
          </div>
          <div class="col-md-4">
            <button
              class="btn btn-outline-secondary w-100"
              (click)="createCategory()"
              [disabled]="!newCategory.categoryName"
            >
              <i class="fas fa-plus me-2"></i>Add Category
            </button>
          </div>
        </div>
      </div>

      <!-- Create Sub-category -->
      <div class="card shadow-sm border-0 rounded-3 p-4 mb-4">
        <h6 class="fw-semibold mb-3">
          <i class="fas fa-folder-plus text-info me-2"></i>Create New Sub-category
        </h6>
        <div class="row g-3">
          <div class="col-md-3">
            <label class="form-label text-muted small">Select Category:</label>
            <select class="form-select" [(ngModel)]="newSubCategory.categoryId">
              <option class="text-center" selected disabled value=-1>-- Select Category --</option>
              <option class="text-center" *ngFor="let cat of categories" [value]="cat.categoryId">
                {{ cat.categoryName }}
              </option>
            </select>
          </div>
          <div class="col-md-4">
            <label class="form-label text-muted small">Sub-category Name:</label>
            <input
              type="text"
              class="form-control"
              [(ngModel)]="newSubCategory.subCategoryName"
              placeholder="Enter sub-category name"
            >
          </div>
          <div class="col-md-2">
            <label class="form-label text-muted small">SlaHours:</label>
            <input
              type="number"
              class="form-control"
              [(ngModel)]="newSubCategory.slaHours"
              placeholder="Enter sla hours"
            >
          </div>
          <div class="col-md-3">
            <label class="form-label text-muted small">&nbsp;</label>
            <button
              class="btn btn-outline-secondary w-100"
              (click)="createSubCategory()"
              [disabled]="!newSubCategory.categoryId || !newSubCategory.slaHours"
            >
              <i class="fas fa-plus me-2"></i>Add Sub-category
            </button>
          </div>
        </div>
      </div>

      <!-- Categories List with Sub-categories -->
      <div class="card shadow-sm border-0 rounded-3 p-4">
        <h6 class="fw-semibold mb-3">
          <i class="fas fa-list text-primary me-2"></i>Categories & Sub-categories List
        </h6>
        <div class="accordion" id="categoriesAccordion">
          <div class="accordion-item" *ngFor="let category of categories; let i = index">
            <h2 class="accordion-header" [id]="'heading' + i">
              <button
                class="accordion-button collapsed"
                type="button"
                data-bs-toggle="collapse"
                [attr.data-bs-target]="'#collapse' + i"
                [attr.aria-expanded]="false"
                [attr.aria-controls]="'collapse' + i"
              >
                <i class="fas fa-folder me-2 text-warning"></i>
                <strong>{{ category.categoryName }}</strong>
                <span class="badge bg-primary ms-2">{{ category.subCategories?.length || 0 }} sub-categories</span>
              </button>
            </h2>
            <div
              [id]="'collapse' + i"
              class="accordion-collapse collapse"
              [attr.aria-labelledby]="'heading' + i"
              data-bs-parent="#categoriesAccordion"
            >
              <div class="accordion-body">
                <div *ngIf="category.subCategories && category.subCategories.length > 0">
                  <ul class="list-group">
                    <li class="list-group-item d-flex justify-content-between align-items-center" *ngFor="let subCat of category.subCategories">
                      <span>
                        <i class="fas fa-angle-right me-2 text-muted"></i>{{ subCat.subCategoryName }}
                      </span>
                      <button
                        class="btn btn-sm btn-outline-danger"
                        (click)="deleteSubCategory(subCat.subCategoryId)"
                      >
                        <i class="fas fa-trash-alt"></i>
                      </button>
                    </li>
                  </ul>
                </div>
                <div *ngIf="!category.subCategories || category.subCategories.length === 0" class="text-center text-muted py-3">
                  <i class="fas fa-inbox fa-2x mb-2"></i>
                  <p class="mb-0">No sub-categories available</p>
                </div>
                <div class="mt-3 text-end">
                  <button
                    class="btn btn-sm btn-outline-danger"
                    (click)="deleteCategory(category.categoryId)"
                  >
                    <i class="fas fa-trash-alt me-1"></i>Delete Category
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div *ngIf="categories.length === 0" class="text-center text-muted py-5">
          <i class="fas fa-folder-open fa-3x mb-3"></i>
          <p class="mb-0">No categories created yet for this department</p>
        </div>
      </div>
    </div>
  </div>